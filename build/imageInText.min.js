function ImageInText(t){function e(){var t=d.text,e=d.height,a=d.height,g=d.width,l=d.font,m=d.fontWeight,c=document.createElement("canvas"),f=document.createElement("canvas"),w=c.getContext("2d"),p=f.getContext("2d");e?g?a=n(w,g,t,l,m):(w.font=m+" "+a+"px "+l,g=w.measureText(t).width):(e=n(w,g,t,l,m),a=e),r||(i.style.width=g+"px",i.style.height=e+"px"),c.width=g,c.height=a,f.width=g,f.height=e,f.innerHTML="<h1>"+t+"</h1>",i.appendChild(f),w.textAlign="center",w.textBaseline="middle",w.font=m+" "+a+"px "+l,w.fillStyle="#000",w.fillText(t,g/2,a/2),p.drawImage(c,0,0,g,e),p.globalCompositeOperation="source-in",g>o.width||e>o.height?(p.fillStyle=p.createPattern(o,"repeat"),p.fillRect(0,0,g,e)):p.drawImage(o,0,0),d.bgImage&&(p.globalCompositeOperation="destination-over",g>h.width||e>h.height?(p.fillStyle=p.createPattern(h,"repeat"),p.fillRect(0,0,g,e)):p.drawImage(h,0,0))}function n(t,e,n,i,a){function o(){t.font=a+" "+r+"px "+i}function h(){return g>t.measureText(n).width}var r=1,g=.98*e;for(o();h();)r++,o();return r}var i,a,o,h,r,g,d={container:"tm-container",text:"Lorem ipsum",font:"fantasy",fontWeight:"normal",width:0,height:0,image:"",bgImage:""};if(t&&"object"==typeof t)for(g in t)t.hasOwnProperty(g)&&d.hasOwnProperty(g)&&typeof t[g]==typeof d[g]&&(d[g]=t[g]);i=document.getElementById(d.container),a=d.height||d.width,o=new Image,h=new Image,a||(r=i.getBoundingClientRect(),d.height=Math.round(r.height),d.width=Math.round(r.width),a=d.height&&d.width),i&&d.image&&a&&(d.bgImage?(h.onload=function(){o.onload=e,o.src=d.image},h.src=d.bgImage):(o.onload=e,o.src=d.image))}